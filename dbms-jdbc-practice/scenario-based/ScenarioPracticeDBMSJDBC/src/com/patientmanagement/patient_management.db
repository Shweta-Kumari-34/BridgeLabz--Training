
============================================================
 Problem: Scenario Based (Patient Management)
 File: patient_management.db
 Table: patients, doctors, visits, appointments
 Database: practice_db
============================================================



CREATE TABLE patients (
patient_id INT PRIMARY KEY AUTO_INCREMENT,
name VARCHAR(60) NOT NULL,
dob DATE NOT NULL,
phone VARCHAR(15) UNIQUE NOT NULL,
email VARCHAR(80) UNIQUE,
address VARCHAR(150),
blood_group VARCHAR(5)
);

INSERT INTO patients (name, dob, phone, email, address, bloodgroup) VALUES 
     ('Alice', '2002-09-23', '6205691993', 'alice349@gmail.com', 'Bhel Nagar', 'A+'),
     ('Bob', '2003-11-12', '9934658922', 'bobaaa2gmail.com', 'RailWay Colony', 'B+'),
     ('Charlie', '1999-09-16', '8802379808', 'charlie@gmail.com', 'Teacher colony', 'B-');

mysql> desc patients;
+------------+-------------+------+-----+---------+----------------+
| Field      | Type        | Null | Key | Default | Extra          |
+------------+-------------+------+-----+---------+----------------+
| name       | varchar(15) | NO   |     | NULL    |                |
| dob        | date        | NO   |     | NULL    |                |
| phone      | varchar(50) | NO   | UNI | NULL    |                |
| email      | varchar(50) | NO   | UNI | NULL    |                |
| address    | varchar(50) | NO   |     | NULL    |                |
| bloodgroup | varchar(3)  | NO   |     | NULL    |                |
| patient_id | int         | NO   | PRI | NULL    | auto_increment |
+------------+-------------+------+-----+---------+----------------+
7 rows in set (0.00 sec)

select *from patients;
+---------+------------+------------+--------------------+----------------+------------+------------+
| name    | dob        | phone      | email              | address        | bloodgroup | patient_id |
+---------+------------+------------+--------------------+----------------+------------+------------+
| Alice   | 2002-09-23 | 6205691993 | alice349@gmail.com | Bhel Nagar     | O+         |          1 |
| Charlie | 1999-09-16 | 8802379808 | charlie@gmail.com  | Teacher colony | B-         |          2 |
| Bob     | 2003-11-12 | 9934658922 | bobaaa2gmail.com   | RailWay Colony | B+         |          3 |
+---------+------------+------------+--------------------+----------------+------------+------------+
3 rows in set (0.00 sec)


 CREATE TABLE doctors( 
doctors_id INT PRIMARY KEY AUTO_INCREMENT,
name VARCHAR(15) NOT NULL,  
specialization VARCHAR(20) NOT NULL
);

CREATE TABLE visits (
         visits_id INT AUTO_INCREMENT PRIMARY KEY,
         appointment_id INT NOT NULL,
         visit_date DATE NOT NULL,
         FOREIGN KEY (appointment_id) REFERENCES appointments(appointment_id)
     );


 CREATE TABLE appointments (
         appointment_id INT AUTO_INCREMENT PRIMARY KEY,
         patient_id INT NOT NULL,
         doctors_id INT NOT NULL,
         appointment_date DATE NOT NULL,
    
         FOREIGN KEY (patient_id) REFERENCES patients(patient_id),
         FOREIGN KEY (doctors_id) REFERENCES doctors(doctors_id)
     );

INSERT INTO doctors ( name, specialization) VALUES ('DR. Amit' , 'Cardiology'), ('Dr.Priya', 'Neurology'), ('Dr.Raj', 'Orthopedic');
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0
 

mysql> select *from doctors;
+------------+----------+----------------+
| doctors_id | name     | specialization |
+------------+----------+----------------+
|          1 | DR. Amit | Cardiology     |
|          2 | Dr.Priya | Neurology      |
|          3 | Dr.Raj   | Orthopedic     |
+------------+----------+----------------+
3 rows in set (0.00 sec)

 UPDATE patients SET bloodgroup = "O+" WHERE bloodgroup= "A+";

INSERT INTO visits(appointment_id, visit_date, diagnosis) VALUES
(10, '2023-06-29', 'Fever'),
(11, '2026-01-26', 'Migrane'),
(12, '2015-02-25', 'Diabetes');


 DESC visits;
+----------------+-------------+------+-----+---------+----------------+
| Field          | Type        | Null | Key | Default | Extra          |
+----------------+-------------+------+-----+---------+----------------+
| visits_id      | int         | NO   | PRI | NULL    | auto_increment |
| appointment_id | int         | NO   | MUL | NULL    |                |
| visit_date     | date        | NO   |     | NULL    |                |
| diagnosis      | varchar(50) | YES  |     | NULL    |                |
+----------------+-------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

 select *from visits;
+-----------+----------------+------------+-----------+
| visits_id | appointment_id | visit_date | diagnosis |
+-----------+----------------+------------+-----------+
|         1 |             10 | 2023-06-29 | Fever     |
|         2 |             11 | 2026-01-26 | Migrane   |
|         3 |             12 | 2015-02-25 | Diabetes  |
+-----------+----------------+------------+-----------+
3 rows in set (0.00 sec)


 desc appointments;
+------------------+------+------+-----+---------+----------------+
| Field            | Type | Null | Key | Default | Extra          |
+------------------+------+------+-----+---------+----------------+
| appointment_id   | int  | NO   | PRI | NULL    | auto_increment |
| patient_id       | int  | NO   | MUL | NULL    |                |
| doctors_id       | int  | NO   | MUL | NULL    |                |
| appointment_date | date | NO   |     | NULL    |                |
+------------------+------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

 INSERT INTO appointments (patient_id, doctors_id, appointment_date)
    -> VALUES
    -> (1, 1, '2020-11-21'),
    -> (2, 2, '2022-08-29'),
    -> (3, 1, '2025-02-28');
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> select *from appointments;
+----------------+------------+------------+------------------+
| appointment_id | patient_id | doctors_id | appointment_date |
+----------------+------------+------------+------------------+
|             10 |          1 |          1 | 2020-11-21       |
|             11 |          2 |          2 | 2022-08-29       |
|             12 |          3 |          1 | 2025-02-28       |
+----------------+------------+------------+------------------+
3 rows in set (0.00 sec)


===========================================================================
                              UPDATE OPERATION
===========================================================================

UPDATE patients SET bloodgroup = "O+" WHERE bloodgroup= "A+";
---+
| Alice | 2002-09-23 | 6205691993 | alice349@gmail.com | Bhel Nagar | O+         |          1 |
+-------+------------+------------+--------------------+------------+------------+------------+
1 row in set (0.00 sec)


==================================================================================
                           SEARCHING ATTRIBUTES USING LIKE OPERATOR
==================================================================================

mysql> SELECT * FROM patients WHERE name Like 'A%';
+-------+------------+------------+--------------------+------------+------------+------------+
| name  | dob        | phone      | email              | address    | bloodgroup | patient_id |
+-------+------------+------------+--------------------+------------+------------+---------



mysql> SELECT *FROM PATIENTS WHERE phone LIKE '620%';
+-------+------------+------------+--------------------+------------+------------+------------+
| name  | dob        | phone      | email              | address    | bloodgroup | patient_id |
+-------+------------+------------+--------------------+------------+------------+---------


===========================================================================================
           
                             jOIN OPERATION

===========================================================================================


SELECT 
    p.patient_id,
    d.name AS doctor_name,
    a.appointment_date,
    v.visit_date
FROM patients p
JOIN appointments a 
    ON p.patient_id = a.patient_id
JOIN doctors d 
    ON a.doctors_id = d.doctors_id
JOIN visits v 
    ON a.appointment_id = v.appointment_id
WHERE p.patient_id = 1
ORDER BY v.visit_date ASC;



    -> ORDER BY v.visit_date ASC;
+------------+-------------+------------------+------------+
| patient_id | doctor_name | appointment_date | visit_date |
+------------+-------------+------------------+------------+
|          1 | DR. Amit    | 2020-11-21       | 2023-06-29 |
+------------+-------------+------------------+------------+
1 row in set (0.00 sec)


















